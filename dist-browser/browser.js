(()=>{var _o=Object.create,vt=Object.defineProperty;var wo=Object.getOwnPropertyDescriptor;var vo=Object.getOwnPropertyNames;var Eo=Object.getPrototypeOf,xo=Object.prototype.hasOwnProperty;var So=t=>vt(t,"__esModule",{value:!0});var b=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Ro=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of vo(e))!xo.call(t,n)&&n!=="default"&&vt(t,n,{get:()=>e[n],enumerable:!(r=wo(e,n))||r.enumerable});return t},Or=t=>Ro(So(vt(t!=null?_o(Eo(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var Xr=b((ql,Ve)=>{var Fr,Br,Nr,Mr,Lr,Pr,Ur,Dr,kr,He,Et,jr,qr,Wr,le,Hr,$r,Vr,Gr,Yr,Kr,Jr,zr,$e;(function(t){var e=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:{};typeof define=="function"&&define.amd?define("tslib",["exports"],function(n){t(r(e,r(n)))}):typeof Ve=="object"&&typeof Ve.exports=="object"?t(r(e,r(Ve.exports))):t(r(e));function r(n,i){return n!==e&&(typeof Object.create=="function"?Object.defineProperty(n,"__esModule",{value:!0}):n.__esModule=!0),function(o,s){return n[o]=i?i(o,s):s}}})(function(t){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])};Fr=function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(n,i);function o(){this.constructor=n}n.prototype=i===null?Object.create(i):(o.prototype=i.prototype,new o)},Br=Object.assign||function(n){for(var i,o=1,s=arguments.length;o<s;o++){i=arguments[o];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])}return n},Nr=function(n,i){var o={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&i.indexOf(s)<0&&(o[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(n);a<s.length;a++)i.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(n,s[a])&&(o[s[a]]=n[s[a]]);return o},Mr=function(n,i,o,s){var a=arguments.length,l=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,o):s,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(n,i,o,s);else for(var u=n.length-1;u>=0;u--)(c=n[u])&&(l=(a<3?c(l):a>3?c(i,o,l):c(i,o))||l);return a>3&&l&&Object.defineProperty(i,o,l),l},Lr=function(n,i){return function(o,s){i(o,s,n)}},Pr=function(n,i){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,i)},Ur=function(n,i,o,s){function a(l){return l instanceof o?l:new o(function(c){c(l)})}return new(o||(o=Promise))(function(l,c){function u(g){try{d(s.next(g))}catch(v){c(v)}}function h(g){try{d(s.throw(g))}catch(v){c(v)}}function d(g){g.done?l(g.value):a(g.value).then(u,h)}d((s=s.apply(n,i||[])).next())})},Dr=function(n,i){var o={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},s,a,l,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(d){return function(g){return h([d,g])}}function h(d){if(s)throw new TypeError("Generator is already executing.");for(;o;)try{if(s=1,a&&(l=d[0]&2?a.return:d[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,d[1])).done)return l;switch(a=0,l&&(d=[d[0]&2,l.value]),d[0]){case 0:case 1:l=d;break;case 4:return o.label++,{value:d[1],done:!1};case 5:o.label++,a=d[1],d=[0];continue;case 7:d=o.ops.pop(),o.trys.pop();continue;default:if(l=o.trys,!(l=l.length>0&&l[l.length-1])&&(d[0]===6||d[0]===2)){o=0;continue}if(d[0]===3&&(!l||d[1]>l[0]&&d[1]<l[3])){o.label=d[1];break}if(d[0]===6&&o.label<l[1]){o.label=l[1],l=d;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(d);break}l[2]&&o.ops.pop(),o.trys.pop();continue}d=i.call(n,o)}catch(g){d=[6,g],a=0}finally{s=l=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},kr=function(n,i){for(var o in n)o!=="default"&&!Object.prototype.hasOwnProperty.call(i,o)&&$e(i,n,o)},$e=Object.create?function(n,i,o,s){s===void 0&&(s=o),Object.defineProperty(n,s,{enumerable:!0,get:function(){return i[o]}})}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]},He=function(n){var i=typeof Symbol=="function"&&Symbol.iterator,o=i&&n[i],s=0;if(o)return o.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")},Et=function(n,i){var o=typeof Symbol=="function"&&n[Symbol.iterator];if(!o)return n;var s=o.call(n),a,l=[],c;try{for(;(i===void 0||i-- >0)&&!(a=s.next()).done;)l.push(a.value)}catch(u){c={error:u}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(c)throw c.error}}return l},jr=function(){for(var n=[],i=0;i<arguments.length;i++)n=n.concat(Et(arguments[i]));return n},qr=function(){for(var n=0,i=0,o=arguments.length;i<o;i++)n+=arguments[i].length;for(var s=Array(n),a=0,i=0;i<o;i++)for(var l=arguments[i],c=0,u=l.length;c<u;c++,a++)s[a]=l[c];return s},Wr=function(n,i){for(var o=0,s=i.length,a=n.length;o<s;o++,a++)n[a]=i[o];return n},le=function(n){return this instanceof le?(this.v=n,this):new le(n)},Hr=function(n,i,o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=o.apply(n,i||[]),a,l=[];return a={},c("next"),c("throw"),c("return"),a[Symbol.asyncIterator]=function(){return this},a;function c(p){s[p]&&(a[p]=function(E){return new Promise(function(S,ae){l.push([p,E,S,ae])>1||u(p,E)})})}function u(p,E){try{h(s[p](E))}catch(S){v(l[0][3],S)}}function h(p){p.value instanceof le?Promise.resolve(p.value.v).then(d,g):v(l[0][2],p)}function d(p){u("next",p)}function g(p){u("throw",p)}function v(p,E){p(E),l.shift(),l.length&&u(l[0][0],l[0][1])}},$r=function(n){var i,o;return i={},s("next"),s("throw",function(a){throw a}),s("return"),i[Symbol.iterator]=function(){return this},i;function s(a,l){i[a]=n[a]?function(c){return(o=!o)?{value:le(n[a](c)),done:a==="return"}:l?l(c):c}:l}},Vr=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n[Symbol.asyncIterator],o;return i?i.call(n):(n=typeof He=="function"?He(n):n[Symbol.iterator](),o={},s("next"),s("throw"),s("return"),o[Symbol.asyncIterator]=function(){return this},o);function s(l){o[l]=n[l]&&function(c){return new Promise(function(u,h){c=n[l](c),a(u,h,c.done,c.value)})}}function a(l,c,u,h){Promise.resolve(h).then(function(d){l({value:d,done:u})},c)}},Gr=function(n,i){return Object.defineProperty?Object.defineProperty(n,"raw",{value:i}):n.raw=i,n};var r=Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i};Yr=function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&$e(i,n,o);return r(i,n),i},Kr=function(n){return n&&n.__esModule?n:{default:n}},Jr=function(n,i){if(!i.has(n))throw new TypeError("attempted to get private field on non-instance");return i.get(n)},zr=function(n,i,o){if(!i.has(n))throw new TypeError("attempted to set private field on non-instance");return i.set(n,o),o},t("__extends",Fr),t("__assign",Br),t("__rest",Nr),t("__decorate",Mr),t("__param",Lr),t("__metadata",Pr),t("__awaiter",Ur),t("__generator",Dr),t("__exportStar",kr),t("__createBinding",$e),t("__values",He),t("__read",Et),t("__spread",jr),t("__spreadArrays",qr),t("__spreadArray",Wr),t("__await",le),t("__asyncGenerator",Hr),t("__asyncDelegator",$r),t("__asyncValues",Vr),t("__makeTemplateObject",Gr),t("__importStar",Yr),t("__importDefault",Kr),t("__classPrivateFieldGet",Jr),t("__classPrivateFieldSet",zr)})});var yn=b((Mf,mn)=>{var de=1e3,pe=de*60,ge=pe*60,Z=ge*24,No=Z*7,Mo=Z*365.25;mn.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return Lo(t);if(r==="number"&&isFinite(t))return e.long?Uo(t):Po(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function Lo(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Mo;case"weeks":case"week":case"w":return r*No;case"days":case"day":case"d":return r*Z;case"hours":case"hour":case"hrs":case"hr":case"h":return r*ge;case"minutes":case"minute":case"mins":case"min":case"m":return r*pe;case"seconds":case"second":case"secs":case"sec":case"s":return r*de;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Po(t){var e=Math.abs(t);return e>=Z?Math.round(t/Z)+"d":e>=ge?Math.round(t/ge)+"h":e>=pe?Math.round(t/pe)+"m":e>=de?Math.round(t/de)+"s":t+"ms"}function Uo(t){var e=Math.abs(t);return e>=Z?ze(t,e,Z,"day"):e>=ge?ze(t,e,ge,"hour"):e>=pe?ze(t,e,pe,"minute"):e>=de?ze(t,e,de,"second"):t+" ms"}function ze(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}});var _n=b((Lf,bn)=>{function Do(t){r.debug=r,r.default=r,r.coerce=l,r.disable=o,r.enable=i,r.enabled=s,r.humanize=yn(),r.destroy=c,Object.keys(t).forEach(u=>{r[u]=t[u]}),r.names=[],r.skips=[],r.formatters={};function e(u){let h=0;for(let d=0;d<u.length;d++)h=(h<<5)-h+u.charCodeAt(d),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=e;function r(u){let h,d=null,g,v;function p(...E){if(!p.enabled)return;let S=p,ae=Number(new Date),mo=ae-(h||ae);S.diff=mo,S.prev=h,S.curr=ae,h=ae,E[0]=r.coerce(E[0]),typeof E[0]!="string"&&E.unshift("%O");let We=0;E[0]=E[0].replace(/%([a-zA-Z%])/g,(wt,yo)=>{if(wt==="%%")return"%";We++;let Ir=r.formatters[yo];if(typeof Ir=="function"){let bo=E[We];wt=Ir.call(S,bo),E.splice(We,1),We--}return wt}),r.formatArgs.call(S,E),(S.log||r.log).apply(S,E)}return p.namespace=u,p.useColors=r.useColors(),p.color=r.selectColor(u),p.extend=n,p.destroy=r.destroy,Object.defineProperty(p,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(g!==r.namespaces&&(g=r.namespaces,v=r.enabled(u)),v),set:E=>{d=E}}),typeof r.init=="function"&&r.init(p),p}function n(u,h){let d=r(this.namespace+(typeof h=="undefined"?":":h)+u);return d.log=this.log,d}function i(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];let h,d=(typeof u=="string"?u:"").split(/[\s,]+/),g=d.length;for(h=0;h<g;h++)!d[h]||(u=d[h].replace(/\*/g,".*?"),u[0]==="-"?r.skips.push(new RegExp("^"+u.substr(1)+"$")):r.names.push(new RegExp("^"+u+"$")))}function o(){let u=[...r.names.map(a),...r.skips.map(a).map(h=>"-"+h)].join(",");return r.enable(""),u}function s(u){if(u[u.length-1]==="*")return!0;let h,d;for(h=0,d=r.skips.length;h<d;h++)if(r.skips[h].test(u))return!1;for(h=0,d=r.names.length;h<d;h++)if(r.names[h].test(u))return!0;return!1}function a(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function l(u){return u instanceof Error?u.stack||u.message:u}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}bn.exports=Do});var wn=b((I,Xe)=>{I.formatArgs=jo;I.save=qo;I.load=Wo;I.useColors=ko;I.storage=Ho();I.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();I.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function ko(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function jo(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+Xe.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),t.splice(n,0,e)}I.log=console.debug||console.log||(()=>{});function qo(t){try{t?I.storage.setItem("debug",t):I.storage.removeItem("debug")}catch(e){}}function Wo(){let t;try{t=I.storage.getItem("debug")}catch(e){}return!t&&typeof process!="undefined"&&"env"in process&&(t=process.env.DEBUG),t}function Ho(){try{return localStorage}catch(t){}}Xe.exports=_n()(I);var{formatters:$o}=Xe.exports;$o.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var En=b((Pf,vn)=>{vn.exports=function(){if(typeof globalThis=="undefined")return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}});var Sn=b(Ze=>{"use strict";Ze.byteLength=Yo;Ze.toByteArray=Jo;Ze.fromByteArray=Zo;var L=[],F=[],Vo=typeof Uint8Array!="undefined"?Uint8Array:Array,Lt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var me=0,Go=Lt.length;me<Go;++me)L[me]=Lt[me],F[Lt.charCodeAt(me)]=me;F["-".charCodeAt(0)]=62;F["_".charCodeAt(0)]=63;function xn(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function Yo(t){var e=xn(t),r=e[0],n=e[1];return(r+n)*3/4-n}function Ko(t,e,r){return(e+r)*3/4-r}function Jo(t){var e,r=xn(t),n=r[0],i=r[1],o=new Vo(Ko(t,n,i)),s=0,a=i>0?n-4:n,l;for(l=0;l<a;l+=4)e=F[t.charCodeAt(l)]<<18|F[t.charCodeAt(l+1)]<<12|F[t.charCodeAt(l+2)]<<6|F[t.charCodeAt(l+3)],o[s++]=e>>16&255,o[s++]=e>>8&255,o[s++]=e&255;return i===2&&(e=F[t.charCodeAt(l)]<<2|F[t.charCodeAt(l+1)]>>4,o[s++]=e&255),i===1&&(e=F[t.charCodeAt(l)]<<10|F[t.charCodeAt(l+1)]<<4|F[t.charCodeAt(l+2)]>>2,o[s++]=e>>8&255,o[s++]=e&255),o}function zo(t){return L[t>>18&63]+L[t>>12&63]+L[t>>6&63]+L[t&63]}function Xo(t,e,r){for(var n,i=[],o=e;o<r;o+=3)n=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(t[o+2]&255),i.push(zo(n));return i.join("")}function Zo(t){for(var e,r=t.length,n=r%3,i=[],o=16383,s=0,a=r-n;s<a;s+=o)i.push(Xo(t,s,s+o>a?a:s+o));return n===1?(e=t[r-1],i.push(L[e>>2]+L[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],i.push(L[e>>10]+L[e>>4&63]+L[e<<2&63]+"=")),i.join("")}});var Rn=b(Pt=>{Pt.read=function(t,e,r,n,i){var o,s,a=i*8-n-1,l=(1<<a)-1,c=l>>1,u=-7,h=r?i-1:0,d=r?-1:1,g=t[e+h];for(h+=d,o=g&(1<<-u)-1,g>>=-u,u+=a;u>0;o=o*256+t[e+h],h+=d,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=n;u>0;s=s*256+t[e+h],h+=d,u-=8);if(o===0)o=1-c;else{if(o===l)return s?NaN:(g?-1:1)*Infinity;s=s+Math.pow(2,n),o=o-c}return(g?-1:1)*s*Math.pow(2,o-n)};Pt.write=function(t,e,r,n,i,o){var s,a,l,c=o*8-i-1,u=(1<<c)-1,h=u>>1,d=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=n?0:o-1,v=n?1:-1,p=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===Infinity?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+h>=1?e+=d/l:e+=d*Math.pow(2,1-h),e*l>=2&&(s++,l/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(e*l-1)*Math.pow(2,i),s=s+h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[r+g]=a&255,g+=v,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[r+g]=s&255,g+=v,s/=256,c-=8);t[r+g-v]|=p*128}});var ee=b(we=>{"use strict";var Ut=Sn(),ye=Rn(),Cn=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;we.Buffer=f;we.SlowBuffer=is;we.INSPECT_MAX_BYTES=50;var Qe=2147483647;we.kMaxLength=Qe;f.TYPED_ARRAY_SUPPORT=Qo();!f.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function Qo(){try{let t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),t.foo()===42}catch(t){return!1}}Object.defineProperty(f.prototype,"parent",{enumerable:!0,get:function(){if(!!f.isBuffer(this))return this.buffer}});Object.defineProperty(f.prototype,"offset",{enumerable:!0,get:function(){if(!!f.isBuffer(this))return this.byteOffset}});function k(t){if(t>Qe)throw new RangeError('The value "'+t+'" is invalid for option "size"');let e=new Uint8Array(t);return Object.setPrototypeOf(e,f.prototype),e}function f(t,e,r){if(typeof t=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Dt(t)}return Tn(t,e,r)}f.poolSize=8192;function Tn(t,e,r){if(typeof t=="string")return ts(t,e);if(ArrayBuffer.isView(t))return rs(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(P(t,ArrayBuffer)||t&&P(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(P(t,SharedArrayBuffer)||t&&P(t.buffer,SharedArrayBuffer)))return jt(t,e,r);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let n=t.valueOf&&t.valueOf();if(n!=null&&n!==t)return f.from(n,e,r);let i=ns(t);if(i)return i;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return f.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}f.from=function(t,e,r){return Tn(t,e,r)};Object.setPrototypeOf(f.prototype,Uint8Array.prototype);Object.setPrototypeOf(f,Uint8Array);function An(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function es(t,e,r){return An(t),t<=0?k(t):e!==void 0?typeof r=="string"?k(t).fill(e,r):k(t).fill(e):k(t)}f.alloc=function(t,e,r){return es(t,e,r)};function Dt(t){return An(t),k(t<0?0:qt(t)|0)}f.allocUnsafe=function(t){return Dt(t)};f.allocUnsafeSlow=function(t){return Dt(t)};function ts(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!f.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let r=In(t,e)|0,n=k(r),i=n.write(t,e);return i!==r&&(n=n.slice(0,i)),n}function kt(t){let e=t.length<0?0:qt(t.length)|0,r=k(e);for(let n=0;n<e;n+=1)r[n]=t[n]&255;return r}function rs(t){if(P(t,Uint8Array)){let e=new Uint8Array(t);return jt(e.buffer,e.byteOffset,e.byteLength)}return kt(t)}function jt(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return e===void 0&&r===void 0?n=new Uint8Array(t):r===void 0?n=new Uint8Array(t,e):n=new Uint8Array(t,e,r),Object.setPrototypeOf(n,f.prototype),n}function ns(t){if(f.isBuffer(t)){let e=qt(t.length)|0,r=k(e);return r.length===0||t.copy(r,0,0,e),r}if(t.length!==void 0)return typeof t.length!="number"||$t(t.length)?k(0):kt(t);if(t.type==="Buffer"&&Array.isArray(t.data))return kt(t.data)}function qt(t){if(t>=Qe)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Qe.toString(16)+" bytes");return t|0}function is(t){return+t!=t&&(t=0),f.alloc(+t)}f.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==f.prototype};f.compare=function(e,r){if(P(e,Uint8Array)&&(e=f.from(e,e.offset,e.byteLength)),P(r,Uint8Array)&&(r=f.from(r,r.offset,r.byteLength)),!f.isBuffer(e)||!f.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;let n=e.length,i=r.length;for(let o=0,s=Math.min(n,i);o<s;++o)if(e[o]!==r[o]){n=e[o],i=r[o];break}return n<i?-1:i<n?1:0};f.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};f.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return f.alloc(0);let n;if(r===void 0)for(r=0,n=0;n<e.length;++n)r+=e[n].length;let i=f.allocUnsafe(r),o=0;for(n=0;n<e.length;++n){let s=e[n];if(P(s,Uint8Array))o+s.length>i.length?(f.isBuffer(s)||(s=f.from(s)),s.copy(i,o)):Uint8Array.prototype.set.call(i,s,o);else if(f.isBuffer(s))s.copy(i,o);else throw new TypeError('"list" argument must be an Array of Buffers');o+=s.length}return i};function In(t,e){if(f.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||P(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let r=t.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&r===0)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return Ht(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return qn(t).length;default:if(i)return n?-1:Ht(t).length;e=(""+e).toLowerCase(),i=!0}}f.byteLength=In;function os(t,e,r){let n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return gs(this,e,r);case"utf8":case"utf-8":return Bn(this,e,r);case"ascii":return ds(this,e,r);case"latin1":case"binary":return ps(this,e,r);case"base64":return cs(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ms(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}f.prototype._isBuffer=!0;function Q(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}f.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<e;r+=2)Q(this,r,r+1);return this};f.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<e;r+=4)Q(this,r,r+3),Q(this,r+1,r+2);return this};f.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<e;r+=8)Q(this,r,r+7),Q(this,r+1,r+6),Q(this,r+2,r+5),Q(this,r+3,r+4);return this};f.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?Bn(this,0,e):os.apply(this,arguments)};f.prototype.toLocaleString=f.prototype.toString;f.prototype.equals=function(e){if(!f.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:f.compare(this,e)===0};f.prototype.inspect=function(){let e="",r=we.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"};Cn&&(f.prototype[Cn]=f.prototype.inspect);f.prototype.compare=function(e,r,n,i,o){if(P(e,Uint8Array)&&(e=f.from(e,e.offset,e.byteLength)),!f.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===void 0&&(r=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),o===void 0&&(o=this.length),r<0||n>e.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&r>=n)return 0;if(i>=o)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,o>>>=0,this===e)return 0;let s=o-i,a=n-r,l=Math.min(s,a),c=this.slice(i,o),u=e.slice(r,n);for(let h=0;h<l;++h)if(c[h]!==u[h]){s=c[h],a=u[h];break}return s<a?-1:a<s?1:0};function On(t,e,r,n,i){if(t.length===0)return-1;if(typeof r=="string"?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,$t(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0)if(i)r=0;else return-1;if(typeof e=="string"&&(e=f.from(e,n)),f.isBuffer(e))return e.length===0?-1:Fn(t,e,r,n,i);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):Fn(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function Fn(t,e,r,n,i){let o=1,s=t.length,a=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(t.length<2||e.length<2)return-1;o=2,s/=2,a/=2,r/=2}function l(u,h){return o===1?u[h]:u.readUInt16BE(h*o)}let c;if(i){let u=-1;for(c=r;c<s;c++)if(l(t,c)===l(e,u===-1?0:c-u)){if(u===-1&&(u=c),c-u+1===a)return u*o}else u!==-1&&(c-=c-u),u=-1}else for(r+a>s&&(r=s-a),c=r;c>=0;c--){let u=!0;for(let h=0;h<a;h++)if(l(t,c+h)!==l(e,h)){u=!1;break}if(u)return c}return-1}f.prototype.includes=function(e,r,n){return this.indexOf(e,r,n)!==-1};f.prototype.indexOf=function(e,r,n){return On(this,e,r,n,!0)};f.prototype.lastIndexOf=function(e,r,n){return On(this,e,r,n,!1)};function ss(t,e,r,n){r=Number(r)||0;let i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;let o=e.length;n>o/2&&(n=o/2);let s;for(s=0;s<n;++s){let a=parseInt(e.substr(s*2,2),16);if($t(a))return s;t[r+s]=a}return s}function as(t,e,r,n){return et(Ht(e,t.length-r),t,r,n)}function ls(t,e,r,n){return et(ws(e),t,r,n)}function us(t,e,r,n){return et(qn(e),t,r,n)}function fs(t,e,r,n){return et(vs(e,t.length-r),t,r,n)}f.prototype.write=function(e,r,n,i){if(r===void 0)i="utf8",n=this.length,r=0;else if(n===void 0&&typeof r=="string")i=r,n=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let o=this.length-r;if((n===void 0||n>o)&&(n=o),e.length>0&&(n<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let s=!1;for(;;)switch(i){case"hex":return ss(this,e,r,n);case"utf8":case"utf-8":return as(this,e,r,n);case"ascii":case"latin1":case"binary":return ls(this,e,r,n);case"base64":return us(this,e,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return fs(this,e,r,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}};f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function cs(t,e,r){return e===0&&r===t.length?Ut.fromByteArray(t):Ut.fromByteArray(t.slice(e,r))}function Bn(t,e,r){r=Math.min(t.length,r);let n=[],i=e;for(;i<r;){let o=t[i],s=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=r){let l,c,u,h;switch(a){case 1:o<128&&(s=o);break;case 2:l=t[i+1],(l&192)==128&&(h=(o&31)<<6|l&63,h>127&&(s=h));break;case 3:l=t[i+1],c=t[i+2],(l&192)==128&&(c&192)==128&&(h=(o&15)<<12|(l&63)<<6|c&63,h>2047&&(h<55296||h>57343)&&(s=h));break;case 4:l=t[i+1],c=t[i+2],u=t[i+3],(l&192)==128&&(c&192)==128&&(u&192)==128&&(h=(o&15)<<18|(l&63)<<12|(c&63)<<6|u&63,h>65535&&h<1114112&&(s=h))}}s===null?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|s&1023),n.push(s),i+=a}return hs(n)}var Nn=4096;function hs(t){let e=t.length;if(e<=Nn)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=Nn));return r}function ds(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]&127);return n}function ps(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function gs(t,e,r){let n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let i="";for(let o=e;o<r;++o)i+=Es[t[o]];return i}function ms(t,e,r){let n=t.slice(e,r),i="";for(let o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+n[o+1]*256);return i}f.prototype.slice=function(e,r){let n=this.length;e=~~e,r=r===void 0?n:~~r,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),r<e&&(r=e);let i=this.subarray(e,r);return Object.setPrototypeOf(i,f.prototype),i};function R(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}f.prototype.readUintLE=f.prototype.readUIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||R(e,r,this.length);let i=this[e],o=1,s=0;for(;++s<r&&(o*=256);)i+=this[e+s]*o;return i};f.prototype.readUintBE=f.prototype.readUIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||R(e,r,this.length);let i=this[e+--r],o=1;for(;r>0&&(o*=256);)i+=this[e+--r]*o;return i};f.prototype.readUint8=f.prototype.readUInt8=function(e,r){return e=e>>>0,r||R(e,1,this.length),this[e]};f.prototype.readUint16LE=f.prototype.readUInt16LE=function(e,r){return e=e>>>0,r||R(e,2,this.length),this[e]|this[e+1]<<8};f.prototype.readUint16BE=f.prototype.readUInt16BE=function(e,r){return e=e>>>0,r||R(e,2,this.length),this[e]<<8|this[e+1]};f.prototype.readUint32LE=f.prototype.readUInt32LE=function(e,r){return e=e>>>0,r||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};f.prototype.readUint32BE=f.prototype.readUInt32BE=function(e,r){return e=e>>>0,r||R(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};f.prototype.readBigUInt64LE=H(function(e){e=e>>>0,_e(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&Me(e,this.length-8);let i=r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,o=this[++e]+this[++e]*2**8+this[++e]*2**16+n*2**24;return BigInt(i)+(BigInt(o)<<BigInt(32))});f.prototype.readBigUInt64BE=H(function(e){e=e>>>0,_e(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&Me(e,this.length-8);let i=r*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],o=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(o)});f.prototype.readIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||R(e,r,this.length);let i=this[e],o=1,s=0;for(;++s<r&&(o*=256);)i+=this[e+s]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*r)),i};f.prototype.readIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||R(e,r,this.length);let i=r,o=1,s=this[e+--i];for(;i>0&&(o*=256);)s+=this[e+--i]*o;return o*=128,s>=o&&(s-=Math.pow(2,8*r)),s};f.prototype.readInt8=function(e,r){return e=e>>>0,r||R(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};f.prototype.readInt16LE=function(e,r){e=e>>>0,r||R(e,2,this.length);let n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};f.prototype.readInt16BE=function(e,r){e=e>>>0,r||R(e,2,this.length);let n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};f.prototype.readInt32LE=function(e,r){return e=e>>>0,r||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};f.prototype.readInt32BE=function(e,r){return e=e>>>0,r||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};f.prototype.readBigInt64LE=H(function(e){e=e>>>0,_e(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&Me(e,this.length-8);let i=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});f.prototype.readBigInt64BE=H(function(e){e=e>>>0,_e(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&Me(e,this.length-8);let i=(r<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n)});f.prototype.readFloatLE=function(e,r){return e=e>>>0,r||R(e,4,this.length),ye.read(this,e,!0,23,4)};f.prototype.readFloatBE=function(e,r){return e=e>>>0,r||R(e,4,this.length),ye.read(this,e,!1,23,4)};f.prototype.readDoubleLE=function(e,r){return e=e>>>0,r||R(e,8,this.length),ye.read(this,e,!0,52,8)};f.prototype.readDoubleBE=function(e,r){return e=e>>>0,r||R(e,8,this.length),ye.read(this,e,!1,52,8)};function A(t,e,r,n,i,o){if(!f.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}f.prototype.writeUintLE=f.prototype.writeUIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;A(this,e,r,n,a,0)}let o=1,s=0;for(this[r]=e&255;++s<n&&(o*=256);)this[r+s]=e/o&255;return r+n};f.prototype.writeUintBE=f.prototype.writeUIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;A(this,e,r,n,a,0)}let o=n-1,s=1;for(this[r+o]=e&255;--o>=0&&(s*=256);)this[r+o]=e/s&255;return r+n};f.prototype.writeUint8=f.prototype.writeUInt8=function(e,r,n){return e=+e,r=r>>>0,n||A(this,e,r,1,255,0),this[r]=e&255,r+1};f.prototype.writeUint16LE=f.prototype.writeUInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||A(this,e,r,2,65535,0),this[r]=e&255,this[r+1]=e>>>8,r+2};f.prototype.writeUint16BE=f.prototype.writeUInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||A(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=e&255,r+2};f.prototype.writeUint32LE=f.prototype.writeUInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||A(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255,r+4};f.prototype.writeUint32BE=f.prototype.writeUInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||A(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};function Mn(t,e,r,n,i){jn(e,n,i,t,r,7);let o=Number(e&BigInt(4294967295));t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s,r}function Ln(t,e,r,n,i){jn(e,n,i,t,r,7);let o=Number(e&BigInt(4294967295));t[r+7]=o,o=o>>8,t[r+6]=o,o=o>>8,t[r+5]=o,o=o>>8,t[r+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=s,s=s>>8,t[r+2]=s,s=s>>8,t[r+1]=s,s=s>>8,t[r]=s,r+8}f.prototype.writeBigUInt64LE=H(function(e,r=0){return Mn(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});f.prototype.writeBigUInt64BE=H(function(e,r=0){return Ln(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});f.prototype.writeIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){let l=Math.pow(2,8*n-1);A(this,e,r,n,l-1,-l)}let o=0,s=1,a=0;for(this[r]=e&255;++o<n&&(s*=256);)e<0&&a===0&&this[r+o-1]!==0&&(a=1),this[r+o]=(e/s>>0)-a&255;return r+n};f.prototype.writeIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){let l=Math.pow(2,8*n-1);A(this,e,r,n,l-1,-l)}let o=n-1,s=1,a=0;for(this[r+o]=e&255;--o>=0&&(s*=256);)e<0&&a===0&&this[r+o+1]!==0&&(a=1),this[r+o]=(e/s>>0)-a&255;return r+n};f.prototype.writeInt8=function(e,r,n){return e=+e,r=r>>>0,n||A(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=e&255,r+1};f.prototype.writeInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||A(this,e,r,2,32767,-32768),this[r]=e&255,this[r+1]=e>>>8,r+2};f.prototype.writeInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||A(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=e&255,r+2};f.prototype.writeInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||A(this,e,r,4,2147483647,-2147483648),this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4};f.prototype.writeInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||A(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};f.prototype.writeBigInt64LE=H(function(e,r=0){return Mn(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});f.prototype.writeBigInt64BE=H(function(e,r=0){return Ln(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Pn(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Un(t,e,r,n,i){return e=+e,r=r>>>0,i||Pn(t,e,r,4,34028234663852886e22,-34028234663852886e22),ye.write(t,e,r,n,23,4),r+4}f.prototype.writeFloatLE=function(e,r,n){return Un(this,e,r,!0,n)};f.prototype.writeFloatBE=function(e,r,n){return Un(this,e,r,!1,n)};function Dn(t,e,r,n,i){return e=+e,r=r>>>0,i||Pn(t,e,r,8,17976931348623157e292,-17976931348623157e292),ye.write(t,e,r,n,52,8),r+8}f.prototype.writeDoubleLE=function(e,r,n){return Dn(this,e,r,!0,n)};f.prototype.writeDoubleBE=function(e,r,n){return Dn(this,e,r,!1,n)};f.prototype.copy=function(e,r,n,i){if(!f.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),r>=e.length&&(r=e.length),r||(r=0),i>0&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-r<i-n&&(i=e.length-r+n);let o=i-n;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),r),o};f.prototype.fill=function(e,r,n,i){if(typeof e=="string"){if(typeof r=="string"?(i=r,r=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!f.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(e.length===1){let s=e.charCodeAt(0);(i==="utf8"&&s<128||i==="latin1")&&(e=s)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r=r>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);let o;if(typeof e=="number")for(o=r;o<n;++o)this[o]=e;else{let s=f.isBuffer(e)?e:f.from(e,i),a=s.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-r;++o)this[o+r]=s[o%a]}return this};var be={};function Wt(t,e,r){be[t]=class extends r{constructor(){super();Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}Wt("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Wt("ERR_INVALID_ARG_TYPE",function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`},TypeError);Wt("ERR_OUT_OF_RANGE",function(t,e,r){let n=`The value of "${t}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=kn(String(r)):typeof r=="bigint"&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=kn(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n},RangeError);function kn(t){let e="",r=t.length,n=t[0]==="-"?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function ys(t,e,r){_e(e,"offset"),(t[e]===void 0||t[e+r]===void 0)&&Me(e,t.length-(r+1))}function jn(t,e,r,n,i,o){if(t>r||t<e){let s=typeof e=="bigint"?"n":"",a;throw o>3?e===0||e===BigInt(0)?a=`>= 0${s} and < 2${s} ** ${(o+1)*8}${s}`:a=`>= -(2${s} ** ${(o+1)*8-1}${s}) and < 2 ** ${(o+1)*8-1}${s}`:a=`>= ${e}${s} and <= ${r}${s}`,new be.ERR_OUT_OF_RANGE("value",a,t)}ys(n,i,o)}function _e(t,e){if(typeof t!="number")throw new be.ERR_INVALID_ARG_TYPE(e,"number",t)}function Me(t,e,r){throw Math.floor(t)!==t?(_e(t,r),new be.ERR_OUT_OF_RANGE(r||"offset","an integer",t)):e<0?new be.ERR_BUFFER_OUT_OF_BOUNDS:new be.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}var bs=/[^+/0-9A-Za-z-_]/g;function _s(t){if(t=t.split("=")[0],t=t.trim().replace(bs,""),t.length<2)return"";for(;t.length%4!=0;)t=t+"=";return t}function Ht(t,e){e=e||Infinity;let r,n=t.length,i=null,o=[];for(let s=0;s<n;++s){if(r=t.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}else if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return o}function ws(t){let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function vs(t,e){let r,n,i,o=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function qn(t){return Ut.toByteArray(_s(t))}function et(t,e,r,n){let i;for(i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function P(t,e){return t instanceof e||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===e.name}function $t(t){return t!==t}var Es=function(){let t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){let n=r*16;for(let i=0;i<16;++i)e[n+i]=t[r]+t[i]}return e}();function H(t){return typeof BigInt=="undefined"?xs:t}function xs(){throw new Error("BigInt not supported")}});var $n=b((Vt,Hn)=>{var tt=ee(),j=tt.Buffer;function Wn(t,e){for(var r in t)e[r]=t[r]}j.from&&j.alloc&&j.allocUnsafe&&j.allocUnsafeSlow?Hn.exports=tt:(Wn(tt,Vt),Vt.Buffer=ve);function ve(t,e,r){return j(t,e,r)}Wn(j,ve);ve.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return j(t,e,r)};ve.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var n=j(t);return e!==void 0?typeof r=="string"?n.fill(e,r):n.fill(e):n.fill(0),n};ve.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return j(t)};ve.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return tt.SlowBuffer(t)}});var Vn=b((qf,Yt)=>{"use strict";var Gt=65536,Ss=4294967295;function Rs(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var Cs=$n().Buffer,rt=global.crypto||global.msCrypto;rt&&rt.getRandomValues?Yt.exports=Ts:Yt.exports=Rs;function Ts(t,e){if(t>Ss)throw new RangeError("requested too many random bytes");var r=Cs.allocUnsafe(t);if(t>0)if(t>Gt)for(var n=0;n<t;n+=Gt)rt.getRandomValues(r.slice(n,n+Gt));else rt.getRandomValues(r);return typeof e=="function"?process.nextTick(function(){e(null,r)}):r}});var Jt=b((Wf,Kt)=>{"use strict";var Ee=typeof Reflect=="object"?Reflect:null,Gn=Ee&&typeof Ee.apply=="function"?Ee.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},nt;Ee&&typeof Ee.ownKeys=="function"?nt=Ee.ownKeys:Object.getOwnPropertySymbols?nt=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:nt=function(e){return Object.getOwnPropertyNames(e)};function As(t){console&&console.warn&&console.warn(t)}var Yn=Number.isNaN||function(e){return e!==e};function w(){w.init.call(this)}Kt.exports=w;Kt.exports.once=Bs;w.EventEmitter=w;w.prototype._events=void 0;w.prototype._eventsCount=0;w.prototype._maxListeners=void 0;var Kn=10;function it(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(w,"defaultMaxListeners",{enumerable:!0,get:function(){return Kn},set:function(t){if(typeof t!="number"||t<0||Yn(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Kn=t}});w.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};w.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Yn(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Jn(t){return t._maxListeners===void 0?w.defaultMaxListeners:t._maxListeners}w.prototype.getMaxListeners=function(){return Jn(this)};w.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(r.length>0&&(s=r[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(l===void 0)return!1;if(typeof l=="function")Gn(l,this,r);else for(var c=l.length,u=ei(l,c),n=0;n<c;++n)Gn(u[n],this,r);return!0};function zn(t,e,r,n){var i,o,s;if(it(r),o=t._events,o===void 0?(o=t._events=Object.create(null),t._eventsCount=0):(o.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),o=t._events),s=o[e]),s===void 0)s=o[e]=r,++t._eventsCount;else if(typeof s=="function"?s=o[e]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),i=Jn(t),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,As(a)}return t}w.prototype.addListener=function(e,r){return zn(this,e,r,!1)};w.prototype.on=w.prototype.addListener;w.prototype.prependListener=function(e,r){return zn(this,e,r,!0)};function Is(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Xn(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=Is.bind(n);return i.listener=r,n.wrapFn=i,i}w.prototype.once=function(e,r){return it(r),this.on(e,Xn(this,e,r)),this};w.prototype.prependOnceListener=function(e,r){return it(r),this.prependListener(e,Xn(this,e,r)),this};w.prototype.removeListener=function(e,r){var n,i,o,s,a;if(it(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount==0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(o=-1,s=n.length-1;s>=0;s--)if(n[s]===r||n[s].listener===r){a=n[s].listener,o=s;break}if(o<0)return this;o===0?n.shift():Os(n,o),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this};w.prototype.off=w.prototype.removeListener;w.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var o=Object.keys(n),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function Zn(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?Fs(i):ei(i,i.length)}w.prototype.listeners=function(e){return Zn(this,e,!0)};w.prototype.rawListeners=function(e){return Zn(this,e,!1)};w.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Qn.call(t,e)};w.prototype.listenerCount=Qn;function Qn(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}w.prototype.eventNames=function(){return this._eventsCount>0?nt(this._events):[]};function ei(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function Os(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Fs(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Bs(t,e){return new Promise(function(r,n){function i(s){t.removeListener(e,o),n(s)}function o(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}ti(t,e,o,{once:!0}),e!=="error"&&Ns(t,i,{once:!0})})}function Ns(t,e,r){typeof t.on=="function"&&ti(t,"error",e,r)}function ti(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(o){n.once&&t.removeEventListener(e,i),r(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}});var zt=b((Hf,ri)=>{ri.exports=Jt().EventEmitter});var Xt=b(()=>{});var si=b((Gf,oi)=>{"use strict";function ni(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ms(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ni(Object(r),!0).forEach(function(n){Ls(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ni(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ls(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ps(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ii(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Us(t,e,r){return e&&ii(t.prototype,e),r&&ii(t,r),t}var Ds=ee(),ot=Ds.Buffer,ks=Xt(),Zt=ks.inspect,js=Zt&&Zt.custom||"inspect";function qs(t,e,r){ot.prototype.copy.call(t,e,r)}oi.exports=function(){function t(){Ps(this,t),this.head=null,this.tail=null,this.length=0}return Us(t,[{key:"push",value:function(r){var n={data:r,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}},{key:"unshift",value:function(r){var n={data:r,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length}},{key:"shift",value:function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(r){if(this.length===0)return"";for(var n=this.head,i=""+n.data;n=n.next;)i+=r+n.data;return i}},{key:"concat",value:function(r){if(this.length===0)return ot.alloc(0);for(var n=ot.allocUnsafe(r>>>0),i=this.head,o=0;i;)qs(i.data,n,o),o+=i.data.length,i=i.next;return n}},{key:"consume",value:function(r,n){var i;return r<this.head.data.length?(i=this.head.data.slice(0,r),this.head.data=this.head.data.slice(r)):r===this.head.data.length?i=this.shift():i=n?this._getString(r):this._getBuffer(r),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(r){var n=this.head,i=1,o=n.data;for(r-=o.length;n=n.next;){var s=n.data,a=r>s.length?s.length:r;if(a===s.length?o+=s:o+=s.slice(0,r),r-=a,r===0){a===s.length?(++i,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=s.slice(a));break}++i}return this.length-=i,o}},{key:"_getBuffer",value:function(r){var n=ot.allocUnsafe(r),i=this.head,o=1;for(i.data.copy(n),r-=i.data.length;i=i.next;){var s=i.data,a=r>s.length?s.length:r;if(s.copy(n,n.length-r,0,a),r-=a,r===0){a===s.length?(++o,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=s.slice(a));break}++o}return this.length-=o,n}},{key:js,value:function(r,n){return Zt(this,Ms({},n,{depth:0,customInspect:!1}))}}]),t}()});var er=b((Yf,li)=>{"use strict";function Ws(t,e){var r=this,n=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return n||i?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(Qt,this,t)):process.nextTick(Qt,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(o){!e&&o?r._writableState?r._writableState.errorEmitted?process.nextTick(st,r):(r._writableState.errorEmitted=!0,process.nextTick(ai,r,o)):process.nextTick(ai,r,o):e?(process.nextTick(st,r),e(o)):process.nextTick(st,r)}),this)}function ai(t,e){Qt(t,e),st(t)}function st(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function Hs(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function Qt(t,e){t.emit("error",e)}function $s(t,e){var r=t._readableState,n=t._writableState;r&&r.autoDestroy||n&&n.autoDestroy?t.destroy(e):t.emit("error",e)}li.exports={destroy:Ws,undestroy:Hs,errorOrDestroy:$s}});var te=b((Kf,ci)=>{"use strict";function Vs(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var ui={};function B(t,e,r){r||(r=Error);function n(o,s,a){return typeof e=="string"?e:e(o,s,a)}var i=function(o){Vs(s,o);function s(a,l,c){return o.call(this,n(a,l,c))||this}return s}(r);i.prototype.name=r.name,i.prototype.code=t,ui[t]=i}function fi(t,e){if(Array.isArray(t)){var r=t.length;return t=t.map(function(n){return String(n)}),r>2?"one of ".concat(e," ").concat(t.slice(0,r-1).join(", "),", or ")+t[r-1]:r===2?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}else return"of ".concat(e," ").concat(String(t))}function Gs(t,e,r){return t.substr(!r||r<0?0:+r,e.length)===e}function Ys(t,e,r){return(r===void 0||r>t.length)&&(r=t.length),t.substring(r-e.length,r)===e}function Ks(t,e,r){return typeof r!="number"&&(r=0),r+e.length>t.length?!1:t.indexOf(e,r)!==-1}B("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError);B("ERR_INVALID_ARG_TYPE",function(t,e,r){var n;typeof e=="string"&&Gs(e,"not ")?(n="must not be",e=e.replace(/^not /,"")):n="must be";var i;if(Ys(t," argument"))i="The ".concat(t," ").concat(n," ").concat(fi(e,"type"));else{var o=Ks(t,".")?"property":"argument";i='The "'.concat(t,'" ').concat(o," ").concat(n," ").concat(fi(e,"type"))}return i+=". Received type ".concat(typeof r),i},TypeError);B("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");B("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"});B("ERR_STREAM_PREMATURE_CLOSE","Premature close");B("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"});B("ERR_MULTIPLE_CALLBACK","Callback called multiple times");B("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");B("ERR_STREAM_WRITE_AFTER_END","write after end");B("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);B("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError);B("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");ci.exports.codes=ui});var tr=b((Jf,hi)=>{"use strict";var Js=te().codes.ERR_INVALID_OPT_VALUE;function zs(t,e,r){return t.highWaterMark!=null?t.highWaterMark:e?t[r]:null}function Xs(t,e,r,n){var i=zs(e,n,r);if(i!=null){if(!(isFinite(i)&&Math.floor(i)===i)||i<0){var o=n?r:"highWaterMark";throw new Js(o,i)}return Math.floor(i)}return t.objectMode?16:16*1024}hi.exports={getHighWaterMark:Xs}});var xe=b((zf,rr)=>{typeof Object.create=="function"?rr.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:rr.exports=function(e,r){if(r){e.super_=r;var n=function(){};n.prototype=r.prototype,e.prototype=new n,e.prototype.constructor=e}}});var pi=b((Xf,di)=>{di.exports=Zs;function Zs(t,e){if(nr("noDeprecation"))return t;var r=!1;function n(){if(!r){if(nr("throwDeprecation"))throw new Error(e);nr("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}return n}function nr(t){try{if(!global.localStorage)return!1}catch(r){return!1}var e=global.localStorage[t];return e==null?!1:String(e).toLowerCase()==="true"}});var sr=b((Zf,wi)=>{"use strict";wi.exports=x;function gi(t){var e=this;this.next=null,this.entry=null,this.finish=function(){Ra(e,t)}}var Se;x.WritableState=Le;var Qs={deprecate:pi()},mi=zt(),at=ee().Buffer,ea=global.Uint8Array||function(){};function ta(t){return at.from(t)}function ra(t){return at.isBuffer(t)||t instanceof ea}var ir=er(),na=tr(),ia=na.getHighWaterMark,$=te().codes,oa=$.ERR_INVALID_ARG_TYPE,sa=$.ERR_METHOD_NOT_IMPLEMENTED,aa=$.ERR_MULTIPLE_CALLBACK,la=$.ERR_STREAM_CANNOT_PIPE,ua=$.ERR_STREAM_DESTROYED,fa=$.ERR_STREAM_NULL_VALUES,ca=$.ERR_STREAM_WRITE_AFTER_END,ha=$.ERR_UNKNOWN_ENCODING,Re=ir.errorOrDestroy;xe()(x,mi);function da(){}function Le(t,e,r){Se=Se||re(),t=t||{},typeof r!="boolean"&&(r=e instanceof Se),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=ia(this,t,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var n=t.decodeStrings===!1;this.decodeStrings=!n,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(i){wa(e,i)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new gi(this)}Le.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r};(function(){try{Object.defineProperty(Le.prototype,"buffer",{get:Qs.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}})();var lt;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(lt=Function.prototype[Symbol.hasInstance],Object.defineProperty(x,Symbol.hasInstance,{value:function(e){return lt.call(this,e)?!0:this!==x?!1:e&&e._writableState instanceof Le}})):lt=function(e){return e instanceof this};function x(t){Se=Se||re();var e=this instanceof Se;if(!e&&!lt.call(x,this))return new x(t);this._writableState=new Le(t,this,e),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),mi.call(this)}x.prototype.pipe=function(){Re(this,new la)};function pa(t,e){var r=new ca;Re(t,r),process.nextTick(e,r)}function ga(t,e,r,n){var i;return r===null?i=new fa:typeof r!="string"&&!e.objectMode&&(i=new oa("chunk",["string","Buffer"],r)),i?(Re(t,i),process.nextTick(n,i),!1):!0}x.prototype.write=function(t,e,r){var n=this._writableState,i=!1,o=!n.objectMode&&ra(t);return o&&!at.isBuffer(t)&&(t=ta(t)),typeof e=="function"&&(r=e,e=null),o?e="buffer":e||(e=n.defaultEncoding),typeof r!="function"&&(r=da),n.ending?pa(this,r):(o||ga(this,n,t,r))&&(n.pendingcb++,i=ya(this,n,o,t,e,r)),i};x.prototype.cork=function(){this._writableState.corked++};x.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&bi(this,t))};x.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new ha(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty(x.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function ma(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=at.from(e,r)),e}Object.defineProperty(x.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function ya(t,e,r,n,i,o){if(!r){var s=ma(e,n,i);n!==s&&(r=!0,i="buffer",n=s)}var a=e.objectMode?1:n.length;e.length+=a;var l=e.length<e.highWaterMark;if(l||(e.needDrain=!0),e.writing||e.corked){var c=e.lastBufferedRequest;e.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},c?c.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else or(t,e,!1,a,n,i,o);return l}function or(t,e,r,n,i,o,s){e.writelen=n,e.writecb=s,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new ua("write")):r?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function ba(t,e,r,n,i){--e.pendingcb,r?(process.nextTick(i,n),process.nextTick(Pe,t,e),t._writableState.errorEmitted=!0,Re(t,n)):(i(n),t._writableState.errorEmitted=!0,Re(t,n),Pe(t,e))}function _a(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function wa(t,e){var r=t._writableState,n=r.sync,i=r.writecb;if(typeof i!="function")throw new aa;if(_a(r),e)ba(t,r,n,e,i);else{var o=_i(r)||t.destroyed;!o&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&bi(t,r),n?process.nextTick(yi,t,r,o,i):yi(t,r,o,i)}}function yi(t,e,r,n){r||va(t,e),e.pendingcb--,n(),Pe(t,e)}function va(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function bi(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var n=e.bufferedRequestCount,i=new Array(n),o=e.corkedRequestsFree;o.entry=r;for(var s=0,a=!0;r;)i[s]=r,r.isBuf||(a=!1),r=r.next,s+=1;i.allBuffers=a,or(t,e,!0,e.length,i,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new gi(e),e.bufferedRequestCount=0}else{for(;r;){var l=r.chunk,c=r.encoding,u=r.callback,h=e.objectMode?1:l.length;if(or(t,e,!1,h,l,c,u),r=r.next,e.bufferedRequestCount--,e.writing)break}r===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}x.prototype._write=function(t,e,r){r(new sa("_write()"))};x.prototype._writev=null;x.prototype.end=function(t,e,r){var n=this._writableState;return typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null),t!=null&&this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||Sa(this,n,r),this};Object.defineProperty(x.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function _i(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function Ea(t,e){t._final(function(r){e.pendingcb--,r&&Re(t,r),e.prefinished=!0,t.emit("prefinish"),Pe(t,e)})}function xa(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,process.nextTick(Ea,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function Pe(t,e){var r=_i(e);if(r&&(xa(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var n=t._readableState;(!n||n.autoDestroy&&n.endEmitted)&&t.destroy()}return r}function Sa(t,e,r){e.ending=!0,Pe(t,e),r&&(e.finished?process.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function Ra(t,e,r){var n=t.entry;for(t.entry=null;n;){var i=n.callback;e.pendingcb--,i(r),n=n.next}e.corkedRequestsFree.next=t}Object.defineProperty(x.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){!this._writableState||(this._writableState.destroyed=e)}});x.prototype.destroy=ir.destroy;x.prototype._undestroy=ir.undestroy;x.prototype._destroy=function(t,e){e(t)}});var re=b((Qf,Ei)=>{"use strict";var Ca=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};Ei.exports=U;var vi=ur(),ar=sr();xe()(U,vi);for(lr=Ca(ar.prototype),ut=0;ut<lr.length;ut++)ft=lr[ut],U.prototype[ft]||(U.prototype[ft]=ar.prototype[ft]);var lr,ft,ut;function U(t){if(!(this instanceof U))return new U(t);vi.call(this,t),ar.call(this,t),this.allowHalfOpen=!0,t&&(t.readable===!1&&(this.readable=!1),t.writable===!1&&(this.writable=!1),t.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",Ta)))}Object.defineProperty(U.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(U.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(U.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Ta(){this._writableState.ended||process.nextTick(Aa,this)}function Aa(t){t.end()}Object.defineProperty(U.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})});var Ri=b((fr,Si)=>{var ct=ee(),D=ct.Buffer;function xi(t,e){for(var r in t)e[r]=t[r]}D.from&&D.alloc&&D.allocUnsafe&&D.allocUnsafeSlow?Si.exports=ct:(xi(ct,fr),fr.Buffer=ne);function ne(t,e,r){return D(t,e,r)}ne.prototype=Object.create(D.prototype);xi(D,ne);ne.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return D(t,e,r)};ne.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var n=D(t);return e!==void 0?typeof r=="string"?n.fill(e,r):n.fill(e):n.fill(0),n};ne.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return D(t)};ne.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return ct.SlowBuffer(t)}});var dr=b(Ti=>{"use strict";var cr=Ri().Buffer,Ci=cr.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function Ia(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function Oa(t){var e=Ia(t);if(typeof e!="string"&&(cr.isEncoding===Ci||!Ci(t)))throw new Error("Unknown encoding: "+t);return e||t}Ti.StringDecoder=Ue;function Ue(t){this.encoding=Oa(t);var e;switch(this.encoding){case"utf16le":this.text=Pa,this.end=Ua,e=4;break;case"utf8":this.fillLast=Na,e=4;break;case"base64":this.text=Da,this.end=ka,e=3;break;default:this.write=ja,this.end=qa;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=cr.allocUnsafe(e)}Ue.prototype.write=function(t){if(t.length===0)return"";var e,r;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""};Ue.prototype.end=La;Ue.prototype.text=Ma;Ue.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function hr(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function Fa(t,e,r){var n=e.length-1;if(n<r)return 0;var i=hr(e[n]);return i>=0?(i>0&&(t.lastNeed=i-1),i):--n<r||i===-2?0:(i=hr(e[n]),i>=0?(i>0&&(t.lastNeed=i-2),i):--n<r||i===-2?0:(i=hr(e[n]),i>=0?(i>0&&(i===2?i=0:t.lastNeed=i-3),i):0))}function Ba(t,e,r){if((e[0]&192)!=128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!=128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!=128)return t.lastNeed=2,"\uFFFD"}}function Na(t){var e=this.lastTotal-this.lastNeed,r=Ba(this,t,e);if(r!==void 0)return r;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function Ma(t,e){var r=Fa(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var n=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)}function La(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function Pa(t,e){if((t.length-e)%2==0){var r=t.toString("utf16le",e);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function Ua(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function Da(t,e){var r=(t.length-e)%3;return r===0?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function ka(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function ja(t){return t.toString(this.encoding)}function qa(t){return t&&t.length?this.write(t):""}});var ht=b((tc,Oi)=>{"use strict";var Ai=te().codes.ERR_STREAM_PREMATURE_CLOSE;function Wa(t){var e=!1;return function(){if(!e){e=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];t.apply(this,n)}}}function Ha(){}function $a(t){return t.setHeader&&typeof t.abort=="function"}function Ii(t,e,r){if(typeof e=="function")return Ii(t,null,e);e||(e={}),r=Wa(r||Ha);var n=e.readable||e.readable!==!1&&t.readable,i=e.writable||e.writable!==!1&&t.writable,o=function(){t.writable||a()},s=t._writableState&&t._writableState.finished,a=function(){i=!1,s=!0,n||r.call(t)},l=t._readableState&&t._readableState.endEmitted,c=function(){n=!1,l=!0,i||r.call(t)},u=function(v){r.call(t,v)},h=function(){var v;if(n&&!l)return(!t._readableState||!t._readableState.ended)&&(v=new Ai),r.call(t,v);if(i&&!s)return(!t._writableState||!t._writableState.ended)&&(v=new Ai),r.call(t,v)},d=function(){t.req.on("finish",a)};return $a(t)?(t.on("complete",a),t.on("abort",h),t.req?d():t.on("request",d)):i&&!t._writableState&&(t.on("end",o),t.on("close",o)),t.on("end",c),t.on("finish",a),e.error!==!1&&t.on("error",u),t.on("close",h),function(){t.removeListener("complete",a),t.removeListener("abort",h),t.removeListener("request",d),t.req&&t.req.removeListener("finish",a),t.removeListener("end",o),t.removeListener("close",o),t.removeListener("finish",a),t.removeListener("end",c),t.removeListener("error",u),t.removeListener("close",h)}}Oi.exports=Ii});var Bi=b((rc,Fi)=>{"use strict";var dt;function V(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Va=ht(),G=Symbol("lastResolve"),ie=Symbol("lastReject"),De=Symbol("error"),pt=Symbol("ended"),oe=Symbol("lastPromise"),pr=Symbol("handlePromise"),se=Symbol("stream");function Y(t,e){return{value:t,done:e}}function Ga(t){var e=t[G];if(e!==null){var r=t[se].read();r!==null&&(t[oe]=null,t[G]=null,t[ie]=null,e(Y(r,!1)))}}function Ya(t){process.nextTick(Ga,t)}function Ka(t,e){return function(r,n){t.then(function(){if(e[pt]){r(Y(void 0,!0));return}e[pr](r,n)},n)}}var Ja=Object.getPrototypeOf(function(){}),za=Object.setPrototypeOf((dt={get stream(){return this[se]},next:function(){var e=this,r=this[De];if(r!==null)return Promise.reject(r);if(this[pt])return Promise.resolve(Y(void 0,!0));if(this[se].destroyed)return new Promise(function(s,a){process.nextTick(function(){e[De]?a(e[De]):s(Y(void 0,!0))})});var n=this[oe],i;if(n)i=new Promise(Ka(n,this));else{var o=this[se].read();if(o!==null)return Promise.resolve(Y(o,!1));i=new Promise(this[pr])}return this[oe]=i,i}},V(dt,Symbol.asyncIterator,function(){return this}),V(dt,"return",function(){var e=this;return new Promise(function(r,n){e[se].destroy(null,function(i){if(i){n(i);return}r(Y(void 0,!0))})})}),dt),Ja),Xa=function(e){var r,n=Object.create(za,(r={},V(r,se,{value:e,writable:!0}),V(r,G,{value:null,writable:!0}),V(r,ie,{value:null,writable:!0}),V(r,De,{value:null,writable:!0}),V(r,pt,{value:e._readableState.endEmitted,writable:!0}),V(r,pr,{value:function(o,s){var a=n[se].read();a?(n[oe]=null,n[G]=null,n[ie]=null,o(Y(a,!1))):(n[G]=o,n[ie]=s)},writable:!0}),r));return n[oe]=null,Va(e,function(i){if(i&&i.code!=="ERR_STREAM_PREMATURE_CLOSE"){var o=n[ie];o!==null&&(n[oe]=null,n[G]=null,n[ie]=null,o(i)),n[De]=i;return}var s=n[G];s!==null&&(n[oe]=null,n[G]=null,n[ie]=null,s(Y(void 0,!0))),n[pt]=!0}),e.on("readable",Ya.bind(null,n)),n};Fi.exports=Xa});var Mi=b((nc,Ni)=>{Ni.exports=function(){throw new Error("Readable.from is not available in the browser")}});var ur=b((oc,$i)=>{"use strict";$i.exports=_;var Ce;_.ReadableState=Pi;var ic=Jt().EventEmitter,Li=function(e,r){return e.listeners(r).length},ke=zt(),gt=ee().Buffer,Za=global.Uint8Array||function(){};function Qa(t){return gt.from(t)}function el(t){return gt.isBuffer(t)||t instanceof Za}var gr=Xt(),m;gr&&gr.debuglog?m=gr.debuglog("stream"):m=function(){};var tl=si(),mr=er(),rl=tr(),nl=rl.getHighWaterMark,mt=te().codes,il=mt.ERR_INVALID_ARG_TYPE,ol=mt.ERR_STREAM_PUSH_AFTER_EOF,sl=mt.ERR_METHOD_NOT_IMPLEMENTED,al=mt.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,Te,yr,br;xe()(_,ke);var je=mr.errorOrDestroy,_r=["error","close","destroy","pause","resume"];function ll(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):Array.isArray(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}function Pi(t,e,r){Ce=Ce||re(),t=t||{},typeof r!="boolean"&&(r=e instanceof Ce),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=nl(this,t,"readableHighWaterMark",r),this.buffer=new tl,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(Te||(Te=dr().StringDecoder),this.decoder=new Te(t.encoding),this.encoding=t.encoding)}function _(t){if(Ce=Ce||re(),!(this instanceof _))return new _(t);var e=this instanceof Ce;this._readableState=new Pi(t,this,e),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),ke.call(this)}Object.defineProperty(_.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){!this._readableState||(this._readableState.destroyed=e)}});_.prototype.destroy=mr.destroy;_.prototype._undestroy=mr.undestroy;_.prototype._destroy=function(t,e){e(t)};_.prototype.push=function(t,e){var r=this._readableState,n;return r.objectMode?n=!0:typeof t=="string"&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=gt.from(t,e),e=""),n=!0),Ui(this,t,e,!1,n)};_.prototype.unshift=function(t){return Ui(this,t,null,!0,!1)};function Ui(t,e,r,n,i){m("readableAddChunk",e);var o=t._readableState;if(e===null)o.reading=!1,cl(t,o);else{var s;if(i||(s=ul(o,e)),s)je(t,s);else if(o.objectMode||e&&e.length>0)if(typeof e!="string"&&!o.objectMode&&Object.getPrototypeOf(e)!==gt.prototype&&(e=Qa(e)),n)o.endEmitted?je(t,new al):wr(t,o,e,!0);else if(o.ended)je(t,new ol);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!r?(e=o.decoder.write(e),o.objectMode||e.length!==0?wr(t,o,e,!1):vr(t,o)):wr(t,o,e,!1)}else n||(o.reading=!1,vr(t,o))}return!o.ended&&(o.length<o.highWaterMark||o.length===0)}function wr(t,e,r,n){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,n?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&yt(t)),vr(t,e)}function ul(t,e){var r;return!el(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(r=new il("chunk",["string","Buffer","Uint8Array"],e)),r}_.prototype.isPaused=function(){return this._readableState.flowing===!1};_.prototype.setEncoding=function(t){Te||(Te=dr().StringDecoder);var e=new Te(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,n="";r!==null;)n+=e.write(r.data),r=r.next;return this._readableState.buffer.clear(),n!==""&&this._readableState.buffer.push(n),this._readableState.length=n.length,this};var Di=1073741824;function fl(t){return t>=Di?t=Di:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function ki(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=fl(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}_.prototype.read=function(t){m("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return m("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?xr(this):yt(this),null;if(t=ki(t,e),t===0&&e.ended)return e.length===0&&xr(this),null;var n=e.needReadable;m("need readable",n),(e.length===0||e.length-t<e.highWaterMark)&&(n=!0,m("length less than watermark",n)),e.ended||e.reading?(n=!1,m("reading or ended",n)):n&&(m("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=ki(r,e)));var i;return t>0?i=Wi(t,e):i=null,i===null?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&xr(this)),i!==null&&this.emit("data",i),i};function cl(t,e){if(m("onEofChunk"),!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.sync?yt(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,ji(t)))}}function yt(t){var e=t._readableState;m("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(m("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(ji,t))}function ji(t){var e=t._readableState;m("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,Er(t)}function vr(t,e){e.readingMore||(e.readingMore=!0,process.nextTick(hl,t,e))}function hl(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var r=e.length;if(m("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}_.prototype._read=function(t){je(this,new sl("_read()"))};_.prototype.pipe=function(t,e){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=t;break;case 1:n.pipes=[n.pipes,t];break;default:n.pipes.push(t);break}n.pipesCount+=1,m("pipe count=%d opts=%j",n.pipesCount,e);var i=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,o=i?a:p;n.endEmitted?process.nextTick(o):r.once("end",o),t.on("unpipe",s);function s(E,S){m("onunpipe"),E===r&&S&&S.hasUnpiped===!1&&(S.hasUnpiped=!0,u())}function a(){m("onend"),t.end()}var l=dl(r);t.on("drain",l);var c=!1;function u(){m("cleanup"),t.removeListener("close",g),t.removeListener("finish",v),t.removeListener("drain",l),t.removeListener("error",d),t.removeListener("unpipe",s),r.removeListener("end",a),r.removeListener("end",p),r.removeListener("data",h),c=!0,n.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&l()}r.on("data",h);function h(E){m("ondata");var S=t.write(E);m("dest.write",S),S===!1&&((n.pipesCount===1&&n.pipes===t||n.pipesCount>1&&Hi(n.pipes,t)!==-1)&&!c&&(m("false write response, pause",n.awaitDrain),n.awaitDrain++),r.pause())}function d(E){m("onerror",E),p(),t.removeListener("error",d),Li(t,"error")===0&&je(t,E)}ll(t,"error",d);function g(){t.removeListener("finish",v),p()}t.once("close",g);function v(){m("onfinish"),t.removeListener("close",g),p()}t.once("finish",v);function p(){m("unpipe"),r.unpipe(t)}return t.emit("pipe",r),n.flowing||(m("pipe resume"),r.resume()),t};function dl(t){return function(){var r=t._readableState;m("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&Li(t,"data")&&(r.flowing=!0,Er(t))}}_.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r),this);if(!t){var n=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=Hi(e.pipes,t);return s===-1?this:(e.pipes.splice(s,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r),this)};_.prototype.on=function(t,e){var r=ke.prototype.on.call(this,t,e),n=this._readableState;return t==="data"?(n.readableListening=this.listenerCount("readable")>0,n.flowing!==!1&&this.resume()):t==="readable"&&!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,m("on readable",n.length,n.reading),n.length?yt(this):n.reading||process.nextTick(pl,this)),r};_.prototype.addListener=_.prototype.on;_.prototype.removeListener=function(t,e){var r=ke.prototype.removeListener.call(this,t,e);return t==="readable"&&process.nextTick(qi,this),r};_.prototype.removeAllListeners=function(t){var e=ke.prototype.removeAllListeners.apply(this,arguments);return(t==="readable"||t===void 0)&&process.nextTick(qi,this),e};function qi(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function pl(t){m("readable nexttick read 0"),t.read(0)}_.prototype.resume=function(){var t=this._readableState;return t.flowing||(m("resume"),t.flowing=!t.readableListening,gl(this,t)),t.paused=!1,this};function gl(t,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(ml,t,e))}function ml(t,e){m("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),Er(t),e.flowing&&!e.reading&&t.read(0)}_.prototype.pause=function(){return m("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(m("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function Er(t){var e=t._readableState;for(m("flow",e.flowing);e.flowing&&t.read()!==null;);}_.prototype.wrap=function(t){var e=this,r=this._readableState,n=!1;t.on("end",function(){if(m("wrapped end"),r.decoder&&!r.ended){var s=r.decoder.end();s&&s.length&&e.push(s)}e.push(null)}),t.on("data",function(s){if(m("wrapped data"),r.decoder&&(s=r.decoder.write(s)),!(r.objectMode&&s==null)&&!(!r.objectMode&&(!s||!s.length))){var a=e.push(s);a||(n=!0,t.pause())}});for(var i in t)this[i]===void 0&&typeof t[i]=="function"&&(this[i]=function(a){return function(){return t[a].apply(t,arguments)}}(i));for(var o=0;o<_r.length;o++)t.on(_r[o],this.emit.bind(this,_r[o]));return this._read=function(s){m("wrapped _read",s),n&&(n=!1,t.resume())},this};typeof Symbol=="function"&&(_.prototype[Symbol.asyncIterator]=function(){return yr===void 0&&(yr=Bi()),yr(this)});Object.defineProperty(_.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(_.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(_.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});_._fromList=Wi;Object.defineProperty(_.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function Wi(t,e){if(e.length===0)return null;var r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.first():r=e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r}function xr(t){var e=t._readableState;m("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(yl,e,t))}function yl(t,e){if(m("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var r=e._writableState;(!r||r.autoDestroy&&r.finished)&&e.destroy()}}typeof Symbol=="function"&&(_.from=function(t,e){return br===void 0&&(br=Mi()),br(_,t,e)});function Hi(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}});var Sr=b((sc,Gi)=>{"use strict";Gi.exports=q;var bt=te().codes,bl=bt.ERR_METHOD_NOT_IMPLEMENTED,_l=bt.ERR_MULTIPLE_CALLBACK,wl=bt.ERR_TRANSFORM_ALREADY_TRANSFORMING,vl=bt.ERR_TRANSFORM_WITH_LENGTH_0,_t=re();xe()(q,_t);function El(t,e){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(n===null)return this.emit("error",new _l);r.writechunk=null,r.writecb=null,e!=null&&this.push(e),n(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function q(t){if(!(this instanceof q))return new q(t);_t.call(this,t),this._transformState={afterTransform:El.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",xl)}function xl(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,r){Vi(t,e,r)}):Vi(this,null,null)}q.prototype.push=function(t,e){return this._transformState.needTransform=!1,_t.prototype.push.call(this,t,e)};q.prototype._transform=function(t,e,r){r(new bl("_transform()"))};q.prototype._write=function(t,e,r){var n=this._transformState;if(n.writecb=r,n.writechunk=t,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}};q.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};q.prototype._destroy=function(t,e){_t.prototype._destroy.call(this,t,function(r){e(r)})};function Vi(t,e,r){if(e)return t.emit("error",e);if(r!=null&&t.push(r),t._writableState.length)throw new vl;if(t._transformState.transforming)throw new wl;return t.push(null)}});var Ji=b((ac,Ki)=>{"use strict";Ki.exports=qe;var Yi=Sr();xe()(qe,Yi);function qe(t){if(!(this instanceof qe))return new qe(t);Yi.call(this,t)}qe.prototype._transform=function(t,e,r){r(null,t)}});var eo=b((lc,Qi)=>{"use strict";var Rr;function Sl(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var zi=te().codes,Rl=zi.ERR_MISSING_ARGS,Cl=zi.ERR_STREAM_DESTROYED;function Xi(t){if(t)throw t}function Tl(t){return t.setHeader&&typeof t.abort=="function"}function Al(t,e,r,n){n=Sl(n);var i=!1;t.on("close",function(){i=!0}),Rr===void 0&&(Rr=ht()),Rr(t,{readable:e,writable:r},function(s){if(s)return n(s);i=!0,n()});var o=!1;return function(s){if(!i&&!o){if(o=!0,Tl(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();n(s||new Cl("pipe"))}}}function Zi(t){t()}function Il(t,e){return t.pipe(e)}function Ol(t){return!t.length||typeof t[t.length-1]!="function"?Xi:t.pop()}function Fl(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=Ol(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new Rl("streams");var i,o=e.map(function(s,a){var l=a<e.length-1,c=a>0;return Al(s,l,c,function(u){i||(i=u),u&&o.forEach(Zi),!l&&(o.forEach(Zi),n(i))})});return e.reduce(Il)}Qi.exports=Fl});var ro=b((N,to)=>{N=to.exports=ur();N.Stream=N;N.Readable=N;N.Writable=sr();N.Duplex=re();N.Transform=Sr();N.PassThrough=Ji();N.finished=ht();N.pipeline=eo()});var oo=b((uc,io)=>{var no;io.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window!="undefined"?window:global):t=>(no||(no=Promise.resolve())).then(t).catch(e=>setTimeout(()=>{throw e},0))});var lo=b((fc,ao)=>{"use strict";function so(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function Bl(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return so(t,r)}catch(n){r.message=t.message,r.stack=t.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(t)),so(new i,r)}}ao.exports=Bl});var po=b((cc,ho)=>{var Nl=wn()("simple-peer"),uo=En(),fo=Vn(),Ml=ro(),Cr=oo(),y=lo(),{Buffer:Ll}=ee(),Tr=64*1024,Pl=5*1e3,Ul=5*1e3;function co(t){return t.replace(/a=ice-options:trickle\s\n/g,"")}function Dl(t){console.warn(t)}var K=class extends Ml.Duplex{constructor(e){if(e=Object.assign({allowHalfOpen:!1},e),super(e),this._id=fo(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||fo(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||K.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},K.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(r=>r),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=e.trickle!==void 0?e.trickle:!0,this.allowHalfTrickle=e.allowHalfTrickle!==void 0?e.allowHalfTrickle:!1,this.iceCompleteTimeout=e.iceCompleteTimeout||Pl,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&typeof e.wrtc=="object"?e.wrtc:uo(),!this._wrtc)throw typeof window=="undefined"?y(new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"),"ERR_WEBRTC_SUPPORT"):y(new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(r){this.destroy(y(r,"ERR_PC_CONSTRUCTOR"));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=r=>{this._onIceCandidate(r)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(r=>{this.destroy(y(r,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=r=>{this._setupData(r)},this.streams&&this.streams.forEach(r=>{this.addStream(r)}),this._pc.ontrack=r=>{this._onTrack(r)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(!this.destroying){if(this.destroyed)throw y(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof e=="string")try{e=JSON.parse(e)}catch(r){e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(r=>{this._addIceCandidate(r)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(r=>{this.destroy(y(r,"ERR_SET_REMOTE_DESCRIPTION"))}),!e.sdp&&!e.candidate&&!e.renegotiate&&!e.transceiverRequest&&this.destroy(y(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(e){let r=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(r).catch(n=>{!r.address||r.address.endsWith(".local")?Dl("Ignoring unsupported ICE candidate."):this.destroy(y(n,"ERR_ADD_ICE_CANDIDATE"))})}send(e){if(!this.destroying){if(this.destroyed)throw y(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(e)}}addTransceiver(e,r){if(!this.destroying){if(this.destroyed)throw y(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,r),this._needsNegotiation()}catch(n){this.destroy(y(n,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:e,init:r}})}}addStream(e){if(!this.destroying){if(this.destroyed)throw y(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),e.getTracks().forEach(r=>{this.addTrack(r,e)})}}addTrack(e,r){if(this.destroying)return;if(this.destroyed)throw y(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");let n=this._senderMap.get(e)||new Map,i=n.get(r);if(!i)i=this._pc.addTrack(e,r),n.set(r,i),this._senderMap.set(e,n),this._needsNegotiation();else throw i.removed?y(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):y(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(e,r,n){if(this.destroying)return;if(this.destroyed)throw y(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");let i=this._senderMap.get(e),o=i?i.get(n):null;if(!o)throw y(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");r&&this._senderMap.set(r,i),o.replaceTrack!=null?o.replaceTrack(r):this.destroy(y(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,r){if(this.destroying)return;if(this.destroyed)throw y(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");let n=this._senderMap.get(e),i=n?n.get(r):null;if(!i)throw y(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{i.removed=!0,this._pc.removeTrack(i)}catch(o){o.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(i):this.destroy(y(o,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){if(!this.destroying){if(this.destroyed)throw y(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),e.getTracks().forEach(r=>{this.removeTrack(r,e)})}}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,Cr(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw y(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(e){this._destroy(e,()=>{})}_destroy(e,r){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",e&&(e.message||e)),Cr(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(n){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(n){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,e&&this.emit("error",e),this.emit("close"),r()}))}_setupData(e){if(!e.channel)return this.destroy(y(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=Tr),this.channelName=this._channel.label,this._channel.onmessage=n=>{this._onChannelMessage(n)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=n=>{let i=n.error instanceof Error?n.error:new Error(`Datachannel error: ${n.message} ${n.filename}:${n.lineno}:${n.colno}`);this.destroy(y(i,"ERR_DATA_CHANNEL"))};let r=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(r&&this._onChannelClose(),r=!0):r=!1},Ul)}_read(){}_write(e,r,n){if(this.destroyed)return n(y(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(i){return this.destroy(y(i,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>Tr?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=n):n(null)}else this._debug("write before connect"),this._chunk=e,this._cb=n}_onFinish(){if(this.destroyed)return;let e=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=co(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let r=()=>{if(this.destroyed)return;let o=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:o.type,sdp:o.sdp})},n=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?r():this.once("_iceComplete",r))},i=o=>{this.destroy(y(o,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(n).catch(i)}).catch(e=>{this.destroy(y(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{!e.mid&&e.sender.track&&!e.requested&&(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=co(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let r=()=>{if(this.destroyed)return;let o=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:o.type,sdp:o.sdp}),this.initiator||this._requestMissingTransceivers()},n=()=>{this.destroyed||(this.trickle||this._iceComplete?r():this.once("_iceComplete",r))},i=o=>{this.destroy(y(o,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(n).catch(i)}).catch(e=>{this.destroy(y(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(y(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;let e=this._pc.iceConnectionState,r=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,r),this.emit("iceStateChange",e,r),(e==="connected"||e==="completed")&&(this._pcReady=!0,this._maybeReady()),e==="failed"&&this.destroy(y(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),e==="closed"&&this.destroy(y(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(e){let r=n=>(Object.prototype.toString.call(n.values)==="[object Array]"&&n.values.forEach(i=>{Object.assign(n,i)}),n);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(n=>{let i=[];n.forEach(o=>{i.push(r(o))}),e(null,i)},n=>e(n)):this._pc.getStats.length>0?this._pc.getStats(n=>{if(this.destroyed)return;let i=[];n.result().forEach(o=>{let s={};o.names().forEach(a=>{s[a]=o.stat(a)}),s.id=o.id,s.type=o.type,s.timestamp=o.timestamp,i.push(r(s))}),e(null,i)},n=>e(n)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;let e=()=>{this.destroyed||this.getStats((r,n)=>{if(this.destroyed)return;r&&(n=[]);let i={},o={},s={},a=!1;n.forEach(c=>{(c.type==="remotecandidate"||c.type==="remote-candidate")&&(i[c.id]=c),(c.type==="localcandidate"||c.type==="local-candidate")&&(o[c.id]=c),(c.type==="candidatepair"||c.type==="candidate-pair")&&(s[c.id]=c)});let l=c=>{a=!0;let u=o[c.localCandidateId];u&&(u.ip||u.address)?(this.localAddress=u.ip||u.address,this.localPort=Number(u.port)):u&&u.ipAddress?(this.localAddress=u.ipAddress,this.localPort=Number(u.portNumber)):typeof c.googLocalAddress=="string"&&(u=c.googLocalAddress.split(":"),this.localAddress=u[0],this.localPort=Number(u[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let h=i[c.remoteCandidateId];h&&(h.ip||h.address)?(this.remoteAddress=h.ip||h.address,this.remotePort=Number(h.port)):h&&h.ipAddress?(this.remoteAddress=h.ipAddress,this.remotePort=Number(h.portNumber)):typeof c.googRemoteAddress=="string"&&(h=c.googRemoteAddress.split(":"),this.remoteAddress=h[0],this.remotePort=Number(h[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(n.forEach(c=>{c.type==="transport"&&c.selectedCandidatePairId&&l(s[c.selectedCandidatePairId]),(c.type==="googCandidatePair"&&c.googActiveConnection==="true"||(c.type==="candidatepair"||c.type==="candidate-pair")&&c.selected)&&l(c)}),!a&&(!Object.keys(s).length||Object.keys(o).length)){setTimeout(e,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(u){return this.destroy(y(u,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');let c=this._cb;this._cb=null,c(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>Tr||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(this.destroyed)return;let r=e.data;r instanceof ArrayBuffer&&(r=Ll.from(r)),this.push(r)}_onChannelBufferedAmountLow(){if(this.destroyed||!this._cb)return;this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);let e=this._cb;this._cb=null,e(null)}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(r=>{this._debug("on track"),this.emit("track",e.track,r),this._remoteTracks.push({track:e.track,stream:r}),!this._remoteStreams.some(n=>n.id===r.id)&&(this._remoteStreams.push(r),Cr(()=>{this._debug("on stream"),this.emit("stream",r)}))})}_debug(){let e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],Nl.apply(null,e)}};K.WEBRTC_SUPPORT=!!uo();K.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};K.channelConfig={};ho.exports=K});var Zr=Or(Xr()),{__extends:W,__assign:Wl,__rest:Hl,__decorate:$l,__param:Vl,__metadata:Gl,__awaiter:Yl,__generator:Kl,__exportStar:Jl,__createBinding:zl,__values:Ie,__read:J,__spread:Xl,__spreadArrays:Zl,__spreadArray:z,__await:Ql,__asyncGenerator:eu,__asyncDelegator:tu,__asyncValues:ru,__makeTemplateObject:nu,__importStar:iu,__importDefault:ou,__classPrivateFieldGet:su,__classPrivateFieldSet:au}=Zr.default;function O(t){return typeof t=="function"}function Ge(t){var e=function(n){Error.call(n),n.stack=new Error().stack},r=t(e);return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}var Ye=Ge(function(t){return function(r){t(this),this.message=r?r.length+` errors occurred during unsubscription:
`+r.map(function(n,i){return i+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=r}});function Oe(t,e){if(t){var r=t.indexOf(e);0<=r&&t.splice(r,1)}}var ue=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._teardowns=null}return t.prototype.unsubscribe=function(){var e,r,n,i,o;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var a=Ie(s),l=a.next();!l.done;l=a.next()){var c=l.value;c.remove(this)}}catch(p){e={error:p}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}else s.remove(this);var u=this.initialTeardown;if(O(u))try{u()}catch(p){o=p instanceof Ye?p.errors:[p]}var h=this._teardowns;if(h){this._teardowns=null;try{for(var d=Ie(h),g=d.next();!g.done;g=d.next()){var v=g.value;try{Qr(v)}catch(p){o=o??[],p instanceof Ye?o=z(z([],J(o),!1),J(p.errors),!1):o.push(p)}}}catch(p){n={error:p}}finally{try{g&&!g.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}}if(o)throw new Ye(o)}},t.prototype.add=function(e){var r;if(e&&e!==this)if(this.closed)Qr(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._teardowns=(r=this._teardowns)!==null&&r!==void 0?r:[]).push(e)}},t.prototype._hasParent=function(e){var r=this._parentage;return r===e||Array.isArray(r)&&r.includes(e)},t.prototype._addParent=function(e){var r=this._parentage;this._parentage=Array.isArray(r)?(r.push(e),r):r?[r,e]:e},t.prototype._removeParent=function(e){var r=this._parentage;r===e?this._parentage=null:Array.isArray(r)&&Oe(r,e)},t.prototype.remove=function(e){var r=this._teardowns;r&&Oe(r,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}();var xt=ue.EMPTY;function Ke(t){return t instanceof ue||t&&"closed"in t&&O(t.remove)&&O(t.add)&&O(t.unsubscribe)}function Qr(t){O(t)?t():t.unsubscribe()}var M={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var fe={setTimeout:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=fe.delegate;return((r==null?void 0:r.setTimeout)||setTimeout).apply(void 0,z([],J(t),!1))},clearTimeout:function(t){var e=fe.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function en(t){fe.setTimeout(function(){var e=M.onUnhandledError;if(e)e(t);else throw t})}function Fe(){}var tn=function(){return St("C",void 0,void 0)}();function rn(t){return St("E",void 0,t)}function nn(t){return St("N",t,void 0)}function St(t,e,r){return{kind:t,value:e,error:r}}var X=null;function ce(t){if(M.useDeprecatedSynchronousErrorHandling){var e=!X;if(e&&(X={errorThrown:!1,error:null}),t(),e){var r=X,n=r.errorThrown,i=r.error;if(X=null,n)throw i}}else t()}function on(t){M.useDeprecatedSynchronousErrorHandling&&X&&(X.errorThrown=!0,X.error=t)}var Rt=function(t){W(e,t);function e(r){var n=t.call(this)||this;return n.isStopped=!1,r?(n.destination=r,Ke(r)&&r.add(n)):n.destination=Co,n}return e.create=function(r,n,i){return new Ct(r,n,i)},e.prototype.next=function(r){this.isStopped?At(nn(r),this):this._next(r)},e.prototype.error=function(r){this.isStopped?At(rn(r),this):(this.isStopped=!0,this._error(r))},e.prototype.complete=function(){this.isStopped?At(tn,this):(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(r){this.destination.next(r)},e.prototype._error=function(r){try{this.destination.error(r)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(ue);var Ct=function(t){W(e,t);function e(r,n,i){var o=t.call(this)||this,s;if(O(r))s=r;else if(r){s=r.next,n=r.error,i=r.complete;var a;o&&M.useDeprecatedNextContext?(a=Object.create(r),a.unsubscribe=function(){return o.unsubscribe()}):a=r,s=s==null?void 0:s.bind(a),n=n==null?void 0:n.bind(a),i=i==null?void 0:i.bind(a)}return o.destination={next:s?Tt(s,o):Fe,error:Tt(n??sn,o),complete:i?Tt(i,o):Fe},o}return e}(Rt);function Tt(t,e){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];try{t.apply(void 0,z([],J(r),!1))}catch(i){M.useDeprecatedSynchronousErrorHandling?on(i):en(i)}}}function sn(t){throw t}function At(t,e){var r=M.onStoppedNotification;r&&fe.setTimeout(function(){return r(t,e)})}var Co={closed:!0,next:Fe,error:sn,complete:Fe};var an=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function ln(t){return t}function un(t){return t.length===0?ln:t.length===1?t[0]:function(r){return t.reduce(function(n,i){return i(n)},r)}}var It=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(e,r,n){var i=this,o=Ao(e)?e:new Ct(e,r,n);return ce(function(){var s=i,a=s.operator,l=s.source;o.add(a?a.call(o,l):l?i._subscribe(o):i._trySubscribe(o))}),o},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(r){e.error(r)}},t.prototype.forEach=function(e,r){var n=this;return r=fn(r),new r(function(i,o){var s;s=n.subscribe(function(a){try{e(a)}catch(l){o(l),s==null||s.unsubscribe()}},o,i)})},t.prototype._subscribe=function(e){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(e)},t.prototype[an]=function(){return this},t.prototype.pipe=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return un(e)(this)},t.prototype.toPromise=function(e){var r=this;return e=fn(e),new e(function(n,i){var o;r.subscribe(function(s){return o=s},function(s){return i(s)},function(){return n(o)})})},t.create=function(e){return new t(e)},t}();function fn(t){var e;return(e=t??M.Promise)!==null&&e!==void 0?e:Promise}function To(t){return t&&O(t.next)&&O(t.error)&&O(t.complete)}function Ao(t){return t&&t instanceof Rt||To(t)&&Ke(t)}var cn=Ge(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}});var T=function(t){W(e,t);function e(){var r=t.call(this)||this;return r.closed=!1,r.observers=[],r.isStopped=!1,r.hasError=!1,r.thrownError=null,r}return e.prototype.lift=function(r){var n=new hn(this,this);return n.operator=r,n},e.prototype._throwIfClosed=function(){if(this.closed)throw new cn},e.prototype.next=function(r){var n=this;ce(function(){var i,o;if(n._throwIfClosed(),!n.isStopped){var s=n.observers.slice();try{for(var a=Ie(s),l=a.next();!l.done;l=a.next()){var c=l.value;c.next(r)}}catch(u){i={error:u}}finally{try{l&&!l.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}}})},e.prototype.error=function(r){var n=this;ce(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=r;for(var i=n.observers;i.length;)i.shift().error(r)}})},e.prototype.complete=function(){var r=this;ce(function(){if(r._throwIfClosed(),!r.isStopped){r.isStopped=!0;for(var n=r.observers;n.length;)n.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var r;return((r=this.observers)===null||r===void 0?void 0:r.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(r){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,r)},e.prototype._subscribe=function(r){return this._throwIfClosed(),this._checkFinalizedStatuses(r),this._innerSubscribe(r)},e.prototype._innerSubscribe=function(r){var n=this,i=n.hasError,o=n.isStopped,s=n.observers;return i||o?xt:(s.push(r),new ue(function(){return Oe(s,r)}))},e.prototype._checkFinalizedStatuses=function(r){var n=this,i=n.hasError,o=n.thrownError,s=n.isStopped;i?r.error(o):s&&r.complete()},e.prototype.asObservable=function(){var r=new It;return r.source=this,r},e.create=function(r,n){return new hn(r,n)},e}(It);var hn=function(t){W(e,t);function e(r,n){var i=t.call(this)||this;return i.destination=r,i.source=n,i}return e.prototype.next=function(r){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.next)===null||i===void 0||i.call(n,r)},e.prototype.error=function(r){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.error)===null||i===void 0||i.call(n,r)},e.prototype.complete=function(){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.complete)===null||n===void 0||n.call(r)},e.prototype._subscribe=function(r){var n,i;return(i=(n=this.source)===null||n===void 0?void 0:n.subscribe(r))!==null&&i!==void 0?i:xt},e}(T);var Be=function(t){W(e,t);function e(r){var n=t.call(this)||this;return n._value=r,n}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(r){var n=t.prototype._subscribe.call(this,r);return!n.closed&&r.next(this._value),n},e.prototype.getValue=function(){var r=this,n=r.hasError,i=r.thrownError,o=r._value;if(n)throw i;return this._throwIfClosed(),o},e.prototype.next=function(r){t.prototype.next.call(this,this._value=r)},e}(T);var Je,Io=new Uint8Array(16);function Ot(){if(!Je&&(Je=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Je))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Je(Io)}var dn=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Oo(t){return typeof t=="string"&&dn.test(t)}var pn=Oo;var C=[];for(var Ft=0;Ft<256;++Ft)C.push((Ft+256).toString(16).substr(1));function Fo(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(C[t[e+0]]+C[t[e+1]]+C[t[e+2]]+C[t[e+3]]+"-"+C[t[e+4]]+C[t[e+5]]+"-"+C[t[e+6]]+C[t[e+7]]+"-"+C[t[e+8]]+C[t[e+9]]+"-"+C[t[e+10]]+C[t[e+11]]+C[t[e+12]]+C[t[e+13]]+C[t[e+14]]+C[t[e+15]]).toLowerCase();if(!pn(r))throw TypeError("Stringified UUID is invalid");return r}var gn=Fo;function Bo(t,e,r){t=t||{};var n=t.random||(t.rng||Ot)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(var i=0;i<16;++i)e[r+i]=n[i];return e}return gn(n)}var Bt=Bo;var he=class{constructor(){this.id="";this.alias="";this.signature="";this.id=Bt(),this.alias=`Anon#${this.getPaddedNumber()}`}getPaddedNumber(){return(""+Math.floor(Math.random()*1e4)).padStart(4,"0")}setAlias(e){this.alias=`${e}#${this.getPaddedNumber()}`}setSignature(e){this.signature=e}};var Nt=class{getNewUser(){let e=new he;return this.setUser(e),new he}};var Mt=class extends Nt{constructor(){super();this.userStorageKey="ogreRouterUser";if(!window||!window.localStorage)throw new Error("Error: this storage service can only be used in the browser");this.localStorage=window.localStorage}setUser(e){this.localStorage.setItem(this.userStorageKey,JSON.stringify(e))}async getUser(){let e=this.localStorage.getItem(this.userStorageKey);if(!e)return this.getNewUser();let r;try{r=JSON.parse(e)}catch(n){return this.getNewUser()}return r}};var Ne=class{constructor(e,r){this.peerlist=new Be([]);this.getOfferSubject=new T;this.getAnswerSubject=new T;this.socket=new WebSocket(r||"ws://localhost:8080"),this.user=e,this.socket.addEventListener("open",this.socketOpened.bind(this)),this.socket.addEventListener("message",this.socketMessage.bind(this))}getPeerList(){return this.peerlist.value}observePeerList(){return this.peerlist.asObservable()}getOffer(){return new Promise(e=>{this.getOfferSubject.subscribe(r=>{e(r)})})}getAnswer(){return new Promise(e=>{this.getAnswerSubject.subscribe(r=>{e(r)})})}observeOffers(){return this.getOfferSubject.asObservable()}sendOffer(e,r){let n=JSON.stringify({event:"sendOffer",data:{target:e,offer:r}});this.socket.send(n)}sendAnswer(e,r){let n=JSON.stringify({event:"sendAnswer",data:{target:e,answer:r}});this.socket.send(n)}socketOpened(){let e=JSON.stringify({event:"userConnection",data:{id:this.user.id,alias:this.user.alias,signature:this.user.signature}});this.socket.send(e)}socketMessage(e){let r;try{r=JSON.parse(e.data)}catch(s){console.log("Error parsing socket message")}if(!r||!r.event)return;let n={getOffer:this.socket_getOffer,getAnswer:this.socket_getAnswer,userAcknowledged:this.socket_userAcknowledged,peerlist:this.socket_peerlist},i=r.event,o=n[i];o&&o.call(this,r.data)}socket_getOffer(e){this.getOfferSubject.next(e)}socket_getAnswer(e){this.getAnswerSubject.next(e)}socket_userAcknowledged(e){e&&e.signature&&this.user.setSignature(e.signature)}socket_peerlist(e){this.peerlist.next(e.filter(r=>this.user.id!==r.id))}};var go=Or(po()),Ae=class{constructor(e){this.answer=new T;this.offer=new T;this.connection=new T;this.data=new T;this.peer=new go.default({initiator:e,trickle:!1});let r=this.peer.push;this.peer.push=(n,i)=>{let o=r.call(this.peer,n,i);return this.data.next(n),o},this.peer.on("error",n=>console.log("error",n)),this.peer.on("signal",n=>{n.type==="answer"?this.answer.next(n):this.offer.next(n)}),this.peer.on("connect",()=>{this.connection.next(void 0)})}getOffer(){return new Promise(e=>{this.offer.subscribe(r=>{e(r)})})}getAnswer(){return new Promise(e=>{this.answer.subscribe(r=>{e(r)})})}onConnection(){return new Promise(e=>{this.connection.subscribe(()=>{e()})})}onData(){return this.data.asObservable()}destroy(){this.answer.complete(),this.offer.complete(),this.connection.complete(),this.data.complete(),this.peer.destroy()}signal(e){this.peer.signal(e)}sendMessage(e){this.peer.send(e)}};var Ar=class{constructor(e){this.targetUser=void 0;this.messages=new T;this.gotUserSubject=new Be(void 0);this.storageService=e&&e.storageService?e.storageService:new Mt,this.storageService.getUser().then(r=>{this.user=r,this.signaler=new Ne(this.user,e?.signalingAddress),this.gotUserSubject.next(r),this.signaler.observeOffers().subscribe(async n=>{let i=new Ae(!1);console.log("socket get offer: ",n),i.signal(n.offer);let o=await i.getAnswer();this.signaler.sendAnswer(n.source,o),i.onData().subscribe(s=>{console.log("got message: ",s),this.transferMessage(s)}),await i.onConnection(),console.log("predecessor connected: ",n)})})}onUserLoaded(){return this.gotUserSubject.asObservable()}observePeerList(){return this.signaler.observePeerList()}observeMessages(){return this.messages.asObservable()}selectTargetPeer(e){this.targetUser=e}async sendMessage(e){console.log(`target ${this.targetUser} sending ${e}`);let r=this.createCircuit(this.targetUser,2),n={bare:!0,message:e,source:this.user.id,sourceAlias:this.user.alias,target:this.targetUser?.id||"",date:new Date},i=this.layerMessage(r,JSON.stringify(n));await this.transferMessage(i)}createCircuit(e,r=1){let n=this.signaler.getPeerList(),i=[];return e&&(n.forEach(o=>{o.id!==this.user.id&&o.id!==e.id&&i.length<r&&i.unshift(o.id)}),i.push(e.id)),i}layerMessage(e,r){let n=r;return e.reverse().forEach(i=>{n=JSON.stringify({next:i,message:n})}),n}async transferMessage(e){let r;try{r=JSON.parse(e)}catch(l){console.log("error parsing assuming this is final message: ",e);return}if(r&&r.bare){this.messages.next(r);return}console.log(e,r);let n=r.message,i=r.next;console.log("targeted user: ",i);let o=new Ae(!0),s=await o.getOffer();this.signaler.sendOffer(i,s);let a=await this.signaler.getAnswer();o.signal(a.answer),await o.onConnection(),o.sendMessage(n),setTimeout(()=>{o.destroy()},100)}};window.Ogre=Ar;window.Router=Ae;window.Signaler=Ne;window.User=he;})();
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
